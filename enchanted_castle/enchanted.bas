   10 HI = 10 : HI$="THE WIZARD"
   20 MODE 8 : PROCopenscreen
   30 VDU 4,28,0,31,39,26
   40 L=550 : COM=0 : CR=0 : AM=0 : NM=0 : TD=0 : MN=0 : beer=0 : REM main loop
   50 GD=0 : F=RND(9) : PROCstring : stay=1 : vin=0 : DV$="999"
   60 B$="" : AMM=0 : SC=0 : GC=0 : PASS=0
   70 ZIG=0 : CR=0 : SD=0 : K=0 : M=0 : OT=0 : ODOOR=0
   80 READ SS : READ TT
   90 IF SS=0 THEN 130 : IF TT=0 THEN 130
  100 SOUND2,-15,SS,TT:SOUND3,-15,SS,TT
  110 DATA 97,15,97,5,101,5,97,5,101,5,97,5,101,10,97,2,89,5,81,5,77,10,0,0
  120 VDU 19,0,RND(4),0,0,0 : GOTO 80
  130 VDU 19,0,0,0,0,0 : PROCscreen
  140 RESTORE
  150 REM
  160 REM
  170 REM
  180 REM        CONTROL
  190 REM
  200 REM
  210 REM
  220 PROCplace
  230 PRINT"What now?"
  240 VDU 23, 0, &A0, 0; 2 : REM Clear out buffer 0.
  250 INPUT A$ : FOR T= 0 TO 100 STEP 5 : SOUND1,-15,T,1 : NEXT
  260 IF A$="LOOK" THEN NM=1 : PROCplace
  270 IF A$="E" THEN NM=1 : PROCeast : PROCscreen : PROCplace
  280 IF A$="W" THEN PROCwest : NM=1 : PROCscreen : PROCplace
  290 IF A$="N" THEN PROCnorth : NM=1 : PROCscreen : PROCplace
  300 IF A$="S" THEN PROCsouth : NM=1 : PROCscreen : PROCplace
  310 IF A$="HELP" THEN NM=1 : PROChelp
  320 IF LEFT$(A$,4)="READ" THEN NM=1 : PROCread
  330 IF LEFT$(A$,4)="OPEN" THEN NM=1 : PROCopen
  340 IF LEFT$(A$,5)="ENTER" THEN NM=1 : PROCenter
  350 IF LEFT$(A$,3)="PUT" THEN NM=1 : PROCput
  360 IF LEFT$(A$,4)="WEAR" THEN NM=1 : PROCwear
  370 IF LEFT$(A$,3)="GET" THEN NM=1 : PROCget
  380 IF LEFT$(A$,11)="COMBINATION" THEN NM=1 : PROCcombination
  390 IF LEFT$(A$,7)="EXAMINE" THEN NM=1 : PRINT"I can only LOOK, but not LOOK AT."
  400 IF LEFT$(A$,6)="UNLOCK" THEN PRINT"Try OPEN or COMBINATION." : NM=1
  410 IF A$="D" THEN NM=1 : PROCdown
  420 IF A$="U" THEN NM=1 : PROCup
  430 IF A$="QUIT" THEN PROCquit
  440 IF A$="L" THEN NM=1 : PROCplace
  450 IF A$="NORTH" THEN PRINT"Try N" : NM=1
  460 IF A$="SOUTH" THEN PRINT"Try S" : NM=1
  470 IF A$="EAST" THEN PRINT"Try E" : NM=1
  480 IF A$="WEST" THEN PRINT"Try W" : NM=1
  490 IF A$="WAIT" THEN PRINT"You wait...................!" : NM=1
  500 IF LEFT$(A$,5)="CLIMB" THEN PRINT"Try UP or ENTER" : NM=1
  510 IF A$="VOCAB" THEN PRINT"E,W,N,S,U,D,WAIT,WEAR,PUT...IN....,GET, HELP,COMBINATION,OPEN,LOOK,QUIT,DROP." : NM=1
  520 IF LEFT$(A$,4)="DROP" THEN NM=1 : PROCdrop
  530 IF A$="PAY GUARD" THEN PROCpay : NM=1
  540 IF A$="" THEN PRINT"I did not hear that!" : NM=1
  550 IF NM=0 THEN PRINT"Say that again?"
  560 NM=0
  570 GOTO 230
  580 DEF PROCput
  590 IF L=550 AND AMM=1 AND A$="PUT BOX IN CUPBOARD" THEN PRINT"You've already done that!" : FOR T= 100 TO 0 STEP -4 : SOUND1,-15,T,1 : NEXT : FOR T= 0 TO 100 STEP 4 : SOUND1,-15,T,1 : NEXT : ENDPROC
  600 IF L=550 AND A$="PUT BOX IN CUPBOARD" THEN SOUND1,-15,100,30 : SOUND2,-15,110,30 : SOUND3,-15,90,30 : AMM=1 : PRINT"With a loud bang, an amulet appears" : SC=SC+5 : ENDPROC
  610 PRINT'"What?!!" : PRINT
  620 ENDPROC
  630 DEF PROCwear
  640 IF L=550 AND AMM=1 AND A$="WEAR AMULET" THEN PRINT"You wear the amulet. Suddenly you shrinkto a foot tall." : AMM=2 : FOR G =1 TO 2000 : NEXT : FOR T =100 TO 0 STEP -4 : SOUND1,-15,T,1 : SOUND2,-15,T,1 : SOUND3,-15,T,1 : NEXT : SC=SC+10 : ENDPROC
  650 IF L=550 AND AMM=2 AND A$="WEAR AMULET" THEN PRINT"You're already wearing it." : ENDPROC
  660 IF L=550 AND AMM=0 AND A$="WEAR AMULET" THEN PRINT"Tut, tut. Trying to cheat!" : ENDPROC
  670 IF A$="WEAR CROWN" AND GC=1 THEN PRINT"You wear the crown." : GC=2 : ENDPROC
  680 IF A$="WEAR CROWN" AND GC=0 AND L=1000 THEN PRINT"You do not have it!" : ENDPROC
  690 IF A$="WEAR CROWN" AND GC=0 AND L<1000 THEN PRINT"It's not here!" : ENDPROC
  700 IF A$="WEAR CROWN" AND GC=2 THEN PRINT"You're already wearing it." : ENDPROC
  710 ENDPROC
  720 DEF PROCplace
  730 IF L=752 AND GD=1 THEN PROCblowup
  740 IF L=148 THEN PRINT"As you enter, the door slams shut!" : PRINT"I see a shaft which leads down. I hear  laughing down the shaft. Exit: Down"
  750 IF L=550 THEN PRINT"I'm in a room with a sign"'"I see a small hole, a scroll, a box and a cupboard. Exit: East"
  760 IF L=650 THEN PRINT"I'm in a room with a coffin"'"I see a sign on the coffin"'"A doorway leads east"'"Exits: East, West"
  770 IF L=750 AND ZIG=0 THEN PRINT"I'm in a room with a safe"'"The safe has a combination lock"'"A doorway leads North"'"Exits: West, North"
  780 IF L=751 THEN PRINT"I'm in a room with a trap door and a"'"sign. The trap door and a sign. The trapdoor is locked"'"I can hear laughter to the north"'"A doorway leads North"'"Exits: South, North"
  790 IF L=752 THEN PRINT"Oh dead, it's the Mad Doctor"'"Keep him happy or he'll blow you up"'"He's going to ask you a question"''"Press a key" : GH=GET
  800 IF L=752 THEN PRINT"What would you drink? Chloroacetic acid or citric acid (CI/CH) ?"
  810 IF L=752 AND GD=0 THEN INPUT B$
  820 IF B$="CI" THEN PRINT"Correct. The Doc gives you some gold" : GD=1 : B$="" : PROCsmile : ENDPROC
  830 IF B$="CH" THEN PRINT"Oh dear. That's wrong. The doctor's justblown you up!"''"You seem to be dead"''"Press a key"; : CV=GET:B$="" : RESTORE : PROCquit
  840 IF L=551 THEN PRINT"I see a door with a sign over it"'"I also see a scroll"'"The door leads north"'"A hole behind me leads south"
  850 IF L=750 AND CR=0 AND ZIG>0 THEN PRINT"I am looking inside the safe"'"I see a cross" : SC=SC+3
  860 IF L=750 AND CR=1 THEN PRINT"I am looking inside the safe"'"I see nothing"
  870 IF L=552 THEN PRINT"I'm in an empty room"'"I see a sign on the wall"'"Exits: South"
  880 IF L=150 THEN PRINT"I'm in the middle of a passage which"'"runs north to south"'"I see a sign"'"Exits: North, South" : SC=SC+5
  890 IF L=900 THEN PRINT"I'm in a pub"'"There is a group of elves drinking"'"They say 'Your round or ours?'" : SC=SC+2 : PROCelves
  900 IF L=1000 THEN PRINT"I'm in the Goblins' Throne Room"'"I see no-one here"'"I see a gold crown"'"I see a Goblin Sentry to the east"''"Exits: East, West" : SC=SC+2
  910 IF L=1100 AND GC=2 AND PASS=1 THEN PRINT"I'm in a room with a fireplace."'"Exits: West"
  920 IF L=1100 AND GC=2 AND PASS=0 THEN PRINT"The Sentry bows and lets you pass."'"I am in a room with a fireplace"''"Exits: West" : PASS=1
  930 IF L=50 THEN PRINT"I'm in a chimney"'"A sign points up"''"Exits: South"
  940 IF L=30 THEN PRINT"I'm in the Elven King's Great Hall. A   guard approaches me. He says 'Pay to"'"pass to the next room!'"
  950 IF L=151 AND stay>1 THEN PROCgoblin
  960 IF L=151 THEN PRINT"I'm at the gates of the Goblins' Palace.Guarding the gates is an ugle goblin."'"The gates are to the north of me."'"I see a window"
  970 IF L=149 THEN PRINT"I'm at the south end of the passage"'"I see a door. It has a combination lock."'"Exits: North"
  980 ENDPROC
  990 DEF PROCeast
 1000 L=L+100 : PROCgobcheck : IF L=650 AND K=1 THEN MN=1 : PROCcoffin
 1010 ENDPROC
 1020 DEF PROCwest
 1030 L=L-100 : IF L=650 AND K=1 THEN MN=1 : PROCcoffin
 1040 ENDPROC
 1050 DEF PROCnorth
 1060 L=L+1
 1070 ENDPROC
 1080 DEF PROCscreen
 1090 IF L=650 AND CR=1 AND K=1 THEN PROCcoffin
 1100 IF L=149 THEN 1840
 1110 IF L=151 THEN 1900
 1120 IF L=152 AND vin=0 THEN PROCgoblin
 1130 IF L=148 THEN 1950
 1140 IF L=900 THEN 2000
 1150 IF L=1000 THEN 2100
 1160 IF L=1100 THEN 2170
 1170 IF L=50 THEN 2270
 1180 IF L=30 AND GC=2 THEN PRINT"An elven guard attacks you with his""Goblin Slayer."'"Splat!"'"You're dead." : PRINT"Press a key" : CB=GET : PROCquit
 1190 IF L=30 AND GC<2 THEN 2320
 1200 IF L=650 THEN 1420
 1210 IF L=550 THEN 1290
 1220 IF L=750 THEN 1480
 1230 IF L=751 THEN 1530
 1240 IF L=752 THEN 1590
 1250 IF L=551 THEN 1710
 1260 IF L=552 THEN 1760
 1270 IF L=150 THEN 1790
 1280 PRINT"You can't go that way!" : PROCno : ENDPROC
 1290 CLG : MOVE 0,200 : DRAW 400,400 : DRAW 1280,400 : MOVE 900,400 : DRAW 900,900 : DRAW 1100,900 : DRAW 1100,400
 1300 MOVE 0,200 : DRAW 1280,200
 1310 MOVE 900,600 : DRAW 1100,600 : MOVE 1000,600 : DRAW 1000,400
 1320 MOVE 1000,600 : DRAW 1000,900
 1330 MOVE 920,620 : DRAW 920,880 : DRAW 980,880 : DRAW 980,620 : DRAW 920,620
 1340 MOVE 1020,620 : DRAW 1020,880 : DRAW 1080,880 : DRAW 1080,620 : DRAW 1020,620
 1350 MOVE 920,420 : DRAW 920,580 : DRAW 980,580 : DRAW 980,420 : DRAW 920,420
 1360 MOVE 1020,420 : DRAW 1020,580 :DRAW 1080,580 : DRAW 1080,420 : DRAW 1020,420
 1370 MOVE 0,1022 : DRAW 1280,1022
 1380 MOVE 550,550 : DRAW 800,550 : DRAW 800,900 : DRAW 550,900 : DRAW 550,550
 1390 MOVE 410,400 : DRAW 420,450 : DRAW 450,460 : DRAW 470,400 : MOVE 400,400 : DRAW 400,1024 : MOVE 0,200 : DRAW 0,1024
 1400 MOVE 0,1020 : DRAW 1278,1020 : DRAW 1278,200
 1410 ENDPROC
 1420 REM ***** SCREEN 650 *******
 1430 CLG : MOVE 0,200 : DRAW 400,400 : DRAW 400,1022 : DRAW 0,1022 : DRAW 1278,1022 : DRAW 1278,200 : DRAW 0,200 :DRAW 0,1024
 1440 MOVE 600,300 : DRAW 500,700 : DRAW 600,900 : DRAW 800,900 : DRAW 900,700 : DRAW 800,300 : DRAW 600,300
 1450 MOVE 400,400 : DRAW 570,400 : MOVE 830,400 : DRAW 1280,400 : MOVE 1100,400 : DRAW 1100,900 : DRAW 1280,900 : MOVE 1100,400 : DRAW 1280,450
 1460 MOVE 650,700 : DRAW 750,700 : DRAW 750,800 : DRAW 650,800 : DRAW 650,700
 1470 ENDPROC
 1480 REM***** SCREEN 750 *******
 1490 CLG : MOVE 0,200 : DRAW 1280,200 : DRAW 900,400 : DRAW 0,400 : MOVE 0,200 : DRAW 0,1022 : DRAW 1278,1022 : DRAW 1278,200
 1500 MOVE 900,400 : DRAW 900,1024 : MOVE 600,600 : DRAW 600,700 :DRAW 700,700 : DRAW 700,600 : DRAW 600,600
 1510 MOVE 615,615 : DRAW 615,685 : DRAW 685,685 : DRAW 685,615 : DRAW 615,615
 1520 MOVE 200,400 : DRAW 200,900 : DRAW 0,900 : MOVE 200,400 : DRAW 0,450 : ENDPROC
 1530 REM ***** SCREEN 751 *********
 1540 CLG : MOVE 0,200 : DRAW 400,400 : DRAW 400,1022 : MOVE 0,1022 : DRAW 1278,1022 : DRAW 1278,200 : DRAW 0,200 : MOVE 400,400 : DRAW 400,1024 : MOVE 400,400 : DRAW 1280,400
 1550 MOVE 0,200 : DRAW 0,1024 : MOVE 600,250 : DRAW 700,350 : DRAW 900,350 : DRAW 800,250 : DRAW 600,250
 1560 MOVE 650,250 : DRAW 750,350 : MOVE 700,250 : DRAW 800,350 : MOVE 750,250 : DRAW 850,350
 1570 MOVE 1100,400 : DRAW 1100,900 : DRAW 1280,900 : MOVE 1100,400 : DRAW 1280,450 : MOVE 600,600 : DRAW 600,700 : DRAW 700,700 : DRAW 700,600 : DRAW 600,600
 1580 ENDPROC
 1590 REM ***** TONY NEIL *******
 1600 CLG : MOVE 0,200 : DRAW 1278,200 : DRAW 1278,1022 : DRAW 0,1022 : DRAW 0,200
 1610 MOVE 500,220 : DRAW 800,220 : DRAW 900,400 : DRAW 900,800 : MOVE 500,220 : DRAW 400,400 : DRAW 400,800 : DRAW 450,850
 1620 DRAW 500,900 : DRAW 800,900 : DRAW 900,800 : MOVE 500,850 : DRAW 800,850 : MOVE 600,750 : DRAW 700,750
 1630 MOVE 550,800 : DRAW 750,800 : MOVE 500,700 : DRAW 600,700 : DRAW 600,650 : DRAW 500,650 : DRAW 500,700
 1640 MOVE 500,675 : DRAW 400,700 : PLOT 69,570,665 : PLOT 69,575,665 : PLOT 69,578,665
 1650 MOVE 600,675 : DRAW 650,700 : DRAW 700,675 : MOVE 700,650 : DRAW 700,700 : DRAW 800,700 : DRAW 800,650 : DRAW 700,650
 1660 PLOT 69,722,665 : PLOT 69,725,665 : PLOT 69,729,665 : MOVE 800,675 : DRAW 900,700
 1670 MOVE 600,640 : DRAW 600,500 : DRAW 650,470 : DRAW 700,500 : DRAW 700,640
 1680 MOVE 500,450 : DRAW 550,400 : DRAW 750,400 : DRAW 797,450
 1690 MOVE 650,900 : DRAW 650,940 : DRAW 675,990 : MOVE 630,900 : DRAW 630,950 : DRAW 600,970 : MOVE 670,900 : DRAW 700,950
 1700 ENDPROC
 1710 IF A$="N" THEN PRINT"THATS A HOLE!!" : L=L-1 : ENDPROC
 1720 CLG : MOVE 0,200 : DRAW 1280,200 : DRAW 900,400 : DRAW 900,1024 : MOVE 1280,1022 : DRAW 0,1022 : DRAW 0,200
 1730 MOVE 0,400 : DRAW 900,400 : MOVE 1278,200 : DRAW 1278,1024
 1740 MOVE 600,400 :DRAW 600,800 : DRAW 800,800 : DRAW 800,400 : MOVE 600,900 : DRAW 800,900 : DRAW 800,850 : DRAW 600,850 : DRAW 600,900
 1750 ENDPROC
 1760 CLG : MOVE 0,200 : DRAW 1278,200 : DRAW 1278,1022 : DRAW 0,1022 : DRAW 0,200 : DRAW 400,400 : DRAW 900,400 : DRAW 1280,200 : MOVE 900,400 : DRAW 900,800
 1770 DRAW 400,800 : DRAW 400,400 : MOVE 400,800 : DRAW 0,1024 : MOVE 900,800 : DRAW 1280,1024 : MOVE 600,500 : DRAW 600,600 : DRAW 700,600 : DRAW 700,500 : DRAW 600,500
 1780 ENDPROC
 1790 REM ******** SCREEN 150 *****
 1800 CLG : MOVE 600,300 : DRAW 600,800 : DRAW 650,800 : DRAW 650,300 : DRAW 600,300 : MOVE 600,700 : DRAW 420,700 : DRAW 400,725 : DRAW 420,750 : DRAW 600,750
 1810 MOVE 650,600 : DRAW 805,600 : DRAW 830,625 : DRAW 805,650 : DRAW 650,650
 1820 MOVE 0,200 : DRAW 0,1022 : DRAW 1278,1022 : DRAW 1278,200 : DRAW 0,200 : MOVE 0,400 : DRAW 600,400 : MOVE 650,400
 1830 ENDPROC
 1840 REM ****** SCREEN 154 ********
 1850 MOVE 0,200 : CLG : DRAW 400,400 : DRAW 400,800 : DRAW 800,800 : DRAW 800,400 : DRAW 1280,200
 1860 MOVE 0,200 : DRAW 0,1022 : DRAW 400,800 : MOVE 800,800 : DRAW 1278,1022 : DRAW 0,1022 : MOVE 0,200 : DRAW 1280,200
 1870 MOVE 400,400:DRAW 800,400 : MOVE 500,400 : DRAW 500,800 : MOVE 600,400 : DRAW 600,800 : MOVE 700,400 : DRAW 700,800
 1880 MOVE 1278,200 : DRAW 1278,1024
 1890 ENDPROC
 1900 REM ******** SCREEN 151 ******:
 1910 CLG : MOVE 0,200 : DRAW 400,400 : DRAW 400,800 :DRAW 800,800 : DRAW 800,400 : DRAW 400,400 : MOVE 0,200 : DRAW 0,1022 : DRAW 1278,1022 : DRAW 800,800
 1920 MOVE 1278,1022 :DRAW 1278,200 : DRAW 0,200 : MOVE 0,1022 : DRAW 400,800 : MOVE 1278,200 : DRAW 800,400
 1930 MOVE 400,700 : DRAW 600,800 : DRAW 800,700 : MOVE 600,800 : DRAW 600,400 : stay=1
 1940 ENDPROC
 1950 CLG : MOVE 0,200 : DRAW 0,1022 : DRAW 1278,1022 : DRAW 1278,200 : DRAW 0,200 : DRAW 400,400 : DRAW 900,400 : DRAW 1280,200 : MOVE 900,400 : DRAW 900,800 : DRAW 1280,1022
 1960 MOVE 400,800 : DRAW 0,1022 : MOVE 400,800 : DRAW 400,400
 1970 MOVE 400,250 : DRAW 600,350 : DRAW 800,350 : DRAW 1000,250 : DRAW 400,250 : MOVE 800,350 : DRAW 800,250 : MOVE 600,350 : DRAW 600,250
 1980 MOVE 400,800 : DRAW 900,800
 1990 ENDPROC
 2000 CLG : MOVE 300,300 : DRAW 300,325 : DRAW 900,325 : DRAW 900,300 : DRAW 300,300
 2010 MOVE 325,325 : DRAW 325,600 : DRAW 875,600 : DRAW 875,325
 2020 MOVE 350,600 : DRAW 350,650 : DRAW 400,650 : DRAW 400,600 : MOVE 360,650 : DRAW 360,800 : DRAW 390,800 : DRAW 390,650
 2030 MOVE 450,600 : DRAW 450,650 : DRAW 500,650 : DRAW 500,600 : MOVE 460,650 : DRAW 460,860 : DRAW 490,800 : DRAW 490,650 : MOVE 600,600 : DRAW 600,650 : DRAW 650,650 : DRAW 650,600 : MOVE 600,630 : DRAW 650,630 : PLOT 85,600,600
 2040 PLOT 85,600,630 : PLOT 85,650,600
 2050 PLOT 85,650,630
 2060 MOVE 0,200 : DRAW 0,1022 : DRAW 1278,1022 : DRAW 1278,200 : DRAW 0,200
 2070 DRAW 300,360 : MOVE 600,600 : DRAW 600,1022
 2080 MOVE 900,300 : DRAW 1280,300
 2090 ENDPROC
 2100 CLG : MOVE 0,200 : DRAW 0,1022 : DRAW 1278,1022 : DRAW 1278,200 : DRAW 0,200 : DRAW 400,400 : DRAW 900,400 : DRAW 1280,200 : MOVE 900,400 : DRAW 900,1022 : MOVE 400,400 : DRAW 400,1022
 2110 MOVE 450,400 : DRAW 450,450 : DRAW 850,450 : DRAW 850,400
 2120 MOVE 500,450 : DRAW 500,900 : DRAW 525,900 : DRAW 525,450
 2130 MOVE 750,450 : DRAW 750,900 : DRAW 775,900 : DRAW 775,450
 2140 MOVE 525,800 : DRAW 632,900 : DRAW 750,800
 2150 MOVE 525,550 : DRAW 750,550 : MOVE 525,575 : DRAW 750,575
 2160 ENDPROC
 2170 CLG : MOVE 0,200 : DRAW 200,400 : DRAW 200,1022 : DRAW 0,1022 : DRAW 0,200
 2180 MOVE 200,1022 : DRAW 1278,1022 : DRAW 1278,200 : DRAW 0,200 : MOVE 1278,200 : DRAW 1078,400 : DRAW 1078,1022
 2190 MOVE 1078,400 : DRAW 200,400 : MOVE 300,400 : DRAW 300,500 : DRAW 400,500 : DRAW 400,400
 2200 MOVE 310,500 : DRAW 310,800 : DRAW 390,800 : DRAW 390,500
 2210 MOVE 310,800 : DRAW 300,800 : DRAW 300,850 : DRAW 950,850 : DRAW 950,800 : DRAW 800,800
 2220 MOVE 940,800 : DRAW 940,500 : MOVE 860,800 : DRAW 860,500 : MOVE 850,500 : DRAW 950,500 : DRAW 950,400
 2230 MOVE 850,500 : DRAW 850,400 : DRAW 800,450 : DRAW 450,450 : DRAW 400,400
 2240 MOVE 450,450 : DRAW 450,800
 2250 MOVE 800,450 : DRAW 800,800
 2260 ENDPROC
 2270 CLG : MOVE 0,200 : DRAW 100,250 : DRAW 1180,250 : DRAW 1280,200
 2280 MOVE 0,200 : DRAW 1278,200 : DRAW 1278,1024 : MOVE 0,200 : DRAW 0,1024 : MOVE 100,250 : DRAW 100,1024 : MOVE 1180,250 : DRAW 1180,1024 : MOVE 0,1022 : DRAW 1280,1022
 2290 MOVE 600,600 : DRAW 600,700 : DRAW 700,700 : DRAW 700,600 : DRAW 600,600 : PLOT 85,700,700 : PLOT 85,600,700
 2300 MOVE 600,700 : DRAW 550,700 : DRAW 650,800 : DRAW 750,700 : DRAW 700,700 : PLOT 85,650,800 : PLOT 85,550,700
 2310 ENDPROC
 2320 CLG : MOVE 0,200 : DRAW 0,1022 : DRAW 1278,1022 : DRAW 1278,200 : DRAW 0,200 : MOVE 0,400 : DRAW 300,800 : DRAW 300,1024
 2330 MOVE 1280,400 : DRAW 980,800 : DRAW 980,1024 : MOVE 200,400: DRAW 500,700 : DRAW 800,700 : DRAW 1100,400 : DRAW 200,400
 2340 DRAW 200,380 : DRAW 1100,380 : DRAW 1100,400 : MOVE 400,380 : DRAW 400,400 : MOVE 450,380 : DRAW 450,200
 2350 MOVE 900,380 : DRAW 900,200 : MOVE 850,380 : DRAW 850,200
 2360 MOVE 600,700 : DRAW 600,800 : DRAW 650,900 : DRAW 700,800 : DRAW 700,700
 2370 MOVE 300,800 : DRAW 600,800 : MOVE 700,800 : DRAW 980,800
 2380 MOVE 400,800 : DRAW 400,1024 : MOVE 900,800 : DRAW 900,1024
 2390 MOVE 650,900 : DRAW 650,1024
 2400 MOVE 660,950 : DRAW 660,975 : DRAW 700,975 : DRAW 700,950 : DRAW 660,950 : PLOT 85,700,975
 2410 PLOT 85,660,975
 2420 SC=SC+30
 2430 ENDPROC
 2440 ENDPROC
 2450 DEF PROChelp
 2460 IF L=550 THEN PRINT"READ SCROLL" : ENDPROC
 2470 IF L=650 THEN PRINT"READ SIGN" : ENDPROC
 2480 IF L=750 THEN PRINT"TO ENTER COMBINATION TYPE THIS          COMBINATION+numbers" : PRINT : ENDPROC
 2490 PRINT"I would like to but I can't!"
 2500 ENDPROC
 2510 DEF PROCsouth
 2520 L=L-1
 2530 IF L=148 AND ODOOR=0 THEN L=L+1 : PRINT"The door is in the way"
 2540 IF L=900 AND A$="S" THEN L=149 : L=L+1 : PROCscreen : ENDPROC
 2550 IF L=49 THEN L=1100
 2560 ENDPROC
 2570 DEF PROCno
 2580 IF A$="N" L=L-1
 2590 IF A$="S" L=L+1
 2600 IF A$="E" L=L-100
 2610 IF A$="W" L=L+100
 2620 ENDPROC
 2630 DEF PROCread
 2640 IF L=550 AND A$="READ SCROLL" THEN PRINT"The amulet is a magical thing which"'"wizards always wear. And if you have a  tidy mind the amulet will appear!" : ENDPROC
 2650 IF L=650 AND A$="READ SIGN" THEN PRINT"Here lies the Vampire of the Castle":ENDPROC
 2660 IF A$="READ SIGN"AND L=751 PRINT"The mad doctor lives here. Beware!":ENDPROC
 2670 IF L=551 AND A$="READ SCROLL" PRINT"The combination is "L$ : ENDPROC
 2680 IF L=551 AND A$="READ SIGN" PRINT"The sign reads 'bar'" : ENDPROC
 2690 IF L=552 AND A$="READ SIGN" PRINT"999 is the second combination." : ENDPROC
 2700 IF L=550 AND A$="READ SIGN" PRINT"The sign says 'Good Luck!'"
 2710 IF L=150 PRINT"The two signs read 'South is a door' and'North is the goblins' palace'" : ENDPROC
 2720 PRINT"Read what?"
 2730 ENDPROC
 2740 DEF PROCopen
 2750 IF L=550 AND A$="OPEN CUPBOARD" PRINT"It's already open!" : ENDPROC
 2760 IF L=550 AND A$="OPEN BOX" PRINT"You hear a voice say 'This is a magical box and cannot be opened. You can tidy  up if you like.'" : ENDPROC
 2770 IF L=750 AND A$="OPEN SAFE" AND COM=0 PRINT"You need the combination" : ENDPROC
 2780 IF L=650 AND A$="OPEN COFFIN"AND CR=0 PRINT"You open the coffin. An angry vampire"'"jumps out and attacks you."''"Oh dead, you seem to be dead."'"Press a key" : X=GET : PROCquit
 2790 IF L=650 AND A$="OPEN COFFIN"AND CR=1 PROCcoffin : ENDPROC
 2800 IF SD=1 AND L=751 AND A$="OPEN DOOR" PROCopentrap : ENDPROC
 2810 IF SD=0 AND L=751 AND A$="OPEN DOOR" PRINT"You need a key." : ENDPROC
 2820 PRINT"Open what?"
 2830 ENDPROC
 2840 DEF PROCenter
 2850 IF L=550 AND A$="ENTER HOLE"AND AMM=0 PRINT"I can't yet. I'm too big" : ENDPROC
 2860 IF L=550 AND AMM=2 AND A$="ENTER HOLE" L=L+1 : PROCscreen : PROCplace : ENDPROC
 2870 IF L<>550 AND A$="ENTER HOLE" PRINT"I don't see it here" : ENDPROC
 2880 IF A$="ENTER FIREPLACE" AND L=1100 L=50 : PROCscreen : PROCplace
 2890 PRINT"Enter what?"
 2900 ENDPROC
 2910 DEF PROCin
 2920 INPUT B$
 2930 ENDPROC
 2940 DEF PROCblowup
 2950 SOUND4,-15,100,70 : FOR X= 1 TO 100 : MOVE 850+RND(200),RND(600) : DRAW RND(1280),RND(1024) : NEXT
 2960 PRINT"What a shame! He's just blown you up!"'"You seem to be dead"'"Press a key" : NM=GET : RESTORE : PROCquit
 2970 DEFPROCsmile
 2980 FOR T= 1 TO 100 STEP 4 : SOUND3,-15,T,1 : NEXT : ENDPROC
 2990 DEF PROCopenscreen
 3000 VDU 23, 0, &A0, 0; 2 : REM Clear out buffer 0.
 3010 COLOUR 10
 3020 PRINT TAB(0,2) "     ******************************"
 3030 PRINT TAB(0,4) "     *                            *"
 3040 PRINT TAB(0,6) "     *  PORTED TO THE AGON LIGHT  *"
 3050 PRINT TAB(0,8) "     *   By STEVE LOVEJOY 2024    *"
 3060 PRINT TAB(0,10)"     *     Originally Written     *"
 3070 PRINT TAB(0,12)"     *   By DAVID BRIMLEY 1984    *"
 3080 PRINT TAB(0,14)"     *                            *"
 3090 PRINT TAB(0,16)"     *    THE ENCHANTED CASTLE    *"
 3100 PRINT TAB(0,18)"     *                            *"
 3110 PRINT TAB(0,20)"     ******************************"
 3120 COLOUR 11 : PRINT TAB(0,24)"          PRESS A KEY  " : VDU 5 : BV=GET
 3130 ENDPROC
 3140 COLOUR 10
 3150 DEF PROCget
 3160 IF L=550 AND AMM=1 PRINT"You put it in the cupboard" : ENDPROC
 3170 IF AMM=0 AND A$="GET AMULET" PRINT"I don't see it here!" : ENDPROC
 3180 IF L=550 AND A$="GET BOX" PRINT"This can be PUT but not GOT!" : ENDPROC
 3190 IF A$="GET CROSS" AND L=750AND ZIG=1 PRINT"You take the cross" : CR=1 : ZIG=2 : ENDPROC
 3200 IF L=650 AND CR=1 AND A$="GET KEY" PRINT"You take the key" : SD=1 : ENDPROC
 3210 IF L=1000 AND GC=1 PRINT"You have got it already, silly!" : ENDPROC
 3220 IF L=1000 PRINT"You take the crown" : GC=1 : ENDPROC
 3230 PRINT"I can't get that!"
 3240 ENDPROC
 3250 DEF PROCstring
 3260 IF F=0 L$="0"
 3270 IF F=1 L$="1"
 3280 IF F=2 L$="2"
 3290 IF F=3 L$="3"
 3300 IF F=4 L$="4"
 3310 IF F=5 L$="5"
 3320 IF F=6 L$="6"
 3330 IF F=7 L$="7"
 3340 IF F=8 L$="8"
 3350 IF F=9 L$="9"
 3360 IF F=10 L$="10"
 3370 ENDPROC
 3380 DEF PROCcombination
 3390 IF L=149 AND RIGHT$(A$,3)=DV$ PROCopendoor
 3400 IF L<>750 PRINT"I can't do that here!"
 3410 IF L=750 AND AMM<2 PRINT"No cheating please!" : ENDPROC
 3420 IF L=750 AND AMM=2 AND RIGHT$(A$,1)=L$ ZIG=1 : PROCopensafe
 3430 ENDPROC
 3440 DEF PROCopensafe
 3450 CLG : MOVE 20,200 : DRAW 20,1000 : DRAW 1260,1000 : DRAW 1260,200 : DRAW 20,200 : MOVE 20,200 : DRAW 400,400 : DRAW 400,800 : DRAW 20,1000
 3460 MOVE 400,800 : DRAW 900,800 : DRAW 1260,1000 : MOVE 900,800 : DRAW 900,400 : DRAW 1260,200
 3470 MOVE 900,400 : DRAW 400,400
 3480 IF CR=0 MOVE 600,410 : DRAW 600,460 :DRAW 570,460 : DRAW 570,500 : DRAW 600,500 : DRAW 600,550 : DRAW 650,550 : DRAW 650,500 : DRAW 680,500
 3490 IF CR=0 DRAW 680,460 : DRAW 650,460 : DRAW 650,410 : DRAW 600,410
 3500 FOR T= 100 TO 200 STEP 4 : SOUND1,-10,T,1 : SOUND2,-10,T+2,1 : SOUND3,-10,T+7,1 : NEXT : FOR T= 200 TO 100 STEP -4 : SOUND1,-10,T,1 : SOUND2,-10,T+2,1 : SOUND3,-10,T+3,1 : NEXT
 3510 PROCplace
 3520 ENDPROC
 3530 IF L=552 PRINT"Think square!" : ENDPROC
 3540 ENDPROC
 3550 DEF PROCcoffin
 3560 CLG : MOVE 500,200 : DRAW 400,700 : DRAW 500,1000 : DRAW 800,1000 : DRAW 900,700 : DRAW 800,200 : DRAW 500,200
 3570 IF SD=1 THEN 3610
 3580 MOVE 620,480 : DRAW 700,480 : DRAW 700,500 : DRAW 675,500 : DRAW 672,520 : DRAW 700,520 : DRAW 700,540 : DRAW 675,540 : DRAW 675,600
 3590 DRAW 700,600 : DRAW 700,700 : DRAW 600,700 : DRAW 600,600 : DRAW 625,600 : DRAW 625,480
 3600 MOVE 620,620 : DRAW 620,680 : DRAW 680,680 : DRAW 680,620 : DRAW 620,620
 3610 IF K=1 AND SD=0 PRINT"I'm looking inside the coffin"'"I see a key"
 3620 IF K=1 AND SD=1 PRINT"I'm looking inside the coffin"'"I see nothing"
 3630 IF K=0 PRINT"An angry vampire jumps out - but sees   your cross and runs away!"'"In the coffin is a key" : K=1
 3640 IF MN=1 MN=0 : GOTO 230
 3650 ENDPROC
 3660 NM=GET : GOTO 40
 3670 ENDPROC
 3680 DEF PROCopentrap
 3690 PRINT"You take the key and open the trap door"'"You can now go down"
 3700 SOUND1,-5,7,150 : SOUND2,-4,100,150 : FOR P= 100 TO 200 : SOUND3,-6,P,1 : NEXT P
 3710 GOTO 230
 3720 DEF PROCdown
 3730 IF L=148 THEN L=900 ELSE IF L=751 THEN L=150
 3740 PROCscreen
 3750 PROCplace
 3760 ENDPROC
 3770 DEF PROCup
 3780 IF L=150 L=751 : PROCscreen : PROCplace
 3790 IF L=900 L=148 : PROCscreen : PROCplace
 3800 IF L=50 L=30 : PROCscreen : PROCplace
 3810 ENDPROC
 3820 DEF PROCgoblin
 3830 CLG : MOVE 0,200 : DRAW 0,1022 : DRAW 1278,1022 : DRAW 1278,200 : DRAW 0,200 : DRAW 200,400 : DRAW 300,300 : DRAW 600,600
 3840 DRAW 900,300 : DRAW 1100,500 : MOVE 1100,200 : DRAW 1100,600 : DRAW 1000,700 : DRAW 1000,750 : DRAW 1025,750 : DRAW 1025,800 : DRAW 1000,800 : DRAW 1000,900
 3850 MOVE 950,900 : DRAW 1280,900 : MOVE 950,900: DRAW 1050,1024
 3860 PLOT 69,1000,775 : FOR T= 1 TO 1000 : NEXT : PLOT 70,1000,775 : PLOT 69,980,750 : FOR T= 1 TO 1000 : NEXT : PLOT 70,980,750 : PLOT 69,975,710 : FOR T= 1 TO 1000 : NEXT : PLOT 70,975,710
 3870 FOR T= 700 TO 210 STEP -10 : PLOT 69,975,T : SOUND1,-15,T,4 : PLOT 70,975,T : NEXT : PLOT 70,975,T
 3880 PRINT"The goblin picks you up and throws you  out of a window"'"Splat!"'"Oh dear, you seem to be dead"'"Press a key"
 3890 X=GET : PROCquit
 3900 GOTO 40
 3910 DEF PROCopendoor
 3920 SOUND1,-15,RND(15),10 : SOUND2,-15,RND(15),10 : SOUND3,-15,RND(15),10
 3930 ODOOR=1 : PRINT"You open the door" : L=148 : PROCscreen : PROCplace : ENDPROC
 3940 DEF PROCelves
 3950 INPUT"(Y/O) "; E$
 3960 IF E$="Y" beer=1
 3970 IF E$="O" beer=2
 3980 XZ=RND(2)
 3990 IF XZ=beer PRINT"You drink the beer. Exits: East" : ENDPROC
 4000 IF XZ<>beer PRINT"Oh dear, they didn't like that. An elf  draws his sword and runs you through.   You're dead."'"Press a key"
 4010 MN=GET : PROCquit
 4020 DEF PROCquit
 4030 VDU 23, 0, &A0, 0; 2 : REM Clear out buffer 0.
 4040 CLS : PRINT"You scored "SC"/100"
 4050 IF SC>HI SC=HI : PRINT"That's a new high score"
 4060 IF SC<HI THEN 4110
 4070 PRINT"Enter your name:"
 4080 INPUT HI$
 4090 IF HI=SC PRINT"Well done "HI$
 4100 PRINT"Press a key" : XC=GET : GOTO 40
 4110 PRINT HI$" has the high score"
 4120 PRINT"Press a key" : XC=GET : GOTO 40
 4130 DEF PROCgobcheck
 4140 IF L=1100AND GC<2 PROCgoblin
 4150 ENDPROC
 4160 DEF PROCdrop
 4170 IF L=50 AND A$="DROP CROWN" PRINT"You drop the crown. It hits the floor"'"and disappears!" : GC=0
 4180 IF L<>50 PRINT"You can't drop that!"
 4190 ENDPROC
 4200 DEF PROCpay
 4210 IF L=30 AND GD=1 L=80:PROCxx
 4220 IF L=30 AND GD=0 PRINT"You have nothing he wants. He is very"'"angry and, with one swift blow of his"'"sword, you fall to the ground. You're"'"dead."'"Press a key" : XC=GET : PROCquit
 4230 IF L<>30 PRINT"I don't see him here"
 4240 ENDPROC
 4250 DEF PROCxx
 4260 VDU 28,0,31,39,0
 4270 VDU 19,0,1,0,0,0 : SC=100
 4280 CLG : CLS : PRINT TAB(1,3)"You pay the guard with your gold. He is so pleased he agrees to escort you out  of the castle. He leaves you at the maingate."''"You've done it!"
 4290 FOR T= 1 TO 200 : SOUND1,-15,RND(255),1 : SOUND2,-5,RND(255),1 : NEXT : VDU 28,0,31,39,26 : PROCquit
